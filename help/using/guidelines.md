---
title: コンポーネントのガイドライン
seo-title: コンポーネントのガイドライン
description: コアコンポーネントは、基盤コンポーネントとは非常に異なる、最新の実装パターンに従います。
seo-description: コアコンポーネントは、基盤コンポーネントとは非常に異なる、最新の実装パターンに従います。
uuid: b1dedea89- da3c-454f-8ab5- d75a19412954
contentOwner: ユーザーは、
content-type: リファレンス
topic-tags: 開発中
products: SG_ PREPERNEMENTMANAGER/COREMENTS- new
discoiquuid: 170dba8f- a2ed-442e- a56e-1126b338c36e
translation-type: tm+mt
source-git-commit: 1bbec9b1f109df88964dce051a58d111bf6cafaa

---


# コンポーネントのガイドライン {#component-guidelines}

[コアコンポーネント](developing.md) は、基盤コンポーネントとは非常に異なる、最新の実装パターンに従います。

このページでは、これらのパターンと、独自の認証可能なコンポーネントを作成するために使用するタイミングについて説明します。最初の節の [«一般コンポーネントパターン»](guidelines.md) は、あらゆる種類のコンポーネントに適用されますが、2番目のセクションの [«再利用可能なコンポーネントパターン](guidelines.md) »は、インスタンスのコアコンポーネントなど、サイトまたはプロジェクト全体で再利用することを目的としたコンポーネントに適用されます。

## 一般的なコンポーネントパターン {#general-component-patterns}

このセクションのガイドラインは、コンポーネントが単一のプロジェクトに固有のものかどうかにかかわらず、またはサイトやプロジェクト全体で広く再利用することを目的として、あらゆる種類のコンポーネントに推奨されます。

### 設定可能なコンポーネント {#configurable-components}

コンポーネントには様々なオプションを使用したダイアログがあります。これは、コンポーネントを柔軟かつ設定可能にするために使用し、相互に大きな違いのある複数のコンポーネントを実装しないようにする必要があります。

通常、ワイヤフレームまたはデザインに同様の要素のバリエーションが含まれている場合、これらのバリエーションは異なるコンポーネントとして実装しないでください。ただし、1つのコンポーネントとして、バリエーション間を選択することができます。

この手順を実行するには、複数のサイトまたはプロジェクトでコンポーネントを再利用する場合は [、事前設定可能な機能](#pre-configurable-capabilities) の節を参照してください。

### 課題の分離 {#separation-of-concerns}

通常は、マークアップテンプレート（またはビュー）とは別のコンポーネントのロジック（モデル）を維持することをお勧めします。これを達成する方法はいくつかありますが、推奨される1つは、コアコンポーネントなどのマークアップに [対してSlingモデル](https://sling.apache.org/documentation/bundles/models.html)[](https://helpx.adobe.com/experience-manager/htl/using/overview.html) を使用することです。

Slingモデルは、POJOSから必要な変数に簡単にアクセスするための一連のJava注釈です。したがって、コンポーネント用のJavaロジックを実装するためのシンプルで強力な方法を提供します。

HTLは、AEM用にカスタマイズされたセキュアでシンプルなテンプレート言語として設計されています。多くのロジックを呼び出すことができるので、非常に柔軟性が高くなります。

## 再利用可能なコンポーネントパターン {#reusable-component-patterns}

このセクションのガイドラインは、任意の種類のコンポーネントにも使用できますが、コアコンポーネントなどのサイトまたはプロジェクト間で再利用することを目的としたコンポーネントでは、最も意味のあるコンポーネントです。これらのガイドラインは、単一のサイトまたはプロジェクトでのみ使用されるコンポーネントでは無視される可能性があります。

### 事前設定可能な機能 {#pre-configurable-capabilities}

ページ作成者が使用する編集ダイアログに加えて、コンポーネントはテンプレート作成者が事前設定するためのデザインダイアログを設定することもできます。[テンプレートエディター](https://helpx.adobe.com/experience-manager/6-5/sites/authoring/using/templates.html) では、これらすべての事前設定を設定できます。これらの設定は「ポリシー」と呼ばれます。

可能な限りコンポーネントを再利用可能にするには、事前設定のために意味のあるオプションを提供する必要があります。これにより、異なるサイトの特定のニーズに合わせて、コンポーネントの機能を有効または無効にすることができます。

<!-- 

Comment Type: annotation
Last Modified By: ims-author-CE1E2CE451D1F0680A490D45@AdobeID
Last Modified Date: 2017-04-17T17:49:04.584-0400

Unclear how I can add my own capability toggle (for example, if i extend a component and want to toggle that extended functionality ... )

 -->

### プロキシコンポーネントパターン {#proxy-component-pattern}

コンテンツリソースには、レンダリングするコンポーネントを参照 `sling:resourceType` するプロパティがあるので、複数のサイトで共有されるコンポーネントを参照するのではなく、これらのプロパティをサイト固有のコンポーネントを指すように指定することをお勧めします。これにより、1つのサイトに対して異なる動作が必要となるので、より柔軟性とコンテンツの再設計が可能になります。これは、サイト固有のコンポーネントではこのカスタマイズを実現し、他のサイトには影響しないためです。

ただし、プロジェクト固有のコンポーネントでコードを複製しない場合は、 `sling:resourceSuperType` プロパティを持つ共有親コンポーネントを参照する必要があります。ほとんどの親コンポーネントを参照するこれらのプロジェクト固有のコンポーネントは、「プロキシコンポーネント」と呼ばれます。機能を完全に継承する場合や、コンポーネントの一部を再定義する場合は、プロキシコンポーネントを完全に空にすることができます。

### コンポーネントのバージョン管理 {#component-versioning}

コンポーネントは、時間とともに完全に互換性を維持する必要があります。ただし、互換性のない変更が必要な場合もあります。これらのニーズに対応する解決策の1つとして、リソースタイプパスに数値を追加し、その実装の完全修飾Javaクラス名でコンポーネントバージョンを導入することが必要です。このバージョン番号は [、セマンティックバージョン付けガイドライン](https://semver.org/)によって定義されるメジャーバージョンを表します。これは、後方互換性のない変更にのみ増加します。

コンポーネントの次の側面に対応しない変更により、新しいバージョンが作成されます。

* Slingモデル（以下のセマンティックバージョンのガイドライン）
* HTLスクリプトとテンプレート
* HTMLマークアップおよびCSSセレクター
* JSON表現
* ダイアログ

詳しくは、GitHubの [バージョン管理ポリシー](https://github.com/adobe/aem-core-wcm-components/wiki/Versioning-Policies) ドキュメントを参照してください。

コンポーネントのバージョン管理では、何かをリファクタリングする必要がある場合に強調表示されるように、アップグレードに重要なコントラクトの形式を作成します。「 [カスタマイズ](customizing.md#upgrade-compatibility-of-customizations)の互換性のアップグレード」セクションも参照してください。アップグレードに必要な様々な形式のカスタマイズについて、アップグレードの互換性が考慮されています。

コンテンツの移行を避けるために、コンテンツリソースからバージョン管理されたコンポーネントを直接参照しないことが重要です。サムのルールでは、コンテンツ `sling:resourceType` の中にバージョン番号がないこと、またはコンポーネントをアップグレードして、コンテンツを再配色する必要があることが必要です。これを回避する最善の方法は、前述の [Proxy Component Pattern](#proxy-component-pattern) に従うことです。

### モデルインターフェイス {#model-interfaces}

このパターンは、Javaインターフェイスを指すHTL `data-sly-use` 命令についてのもので、Slingモデルの実装もそのコンポーネントのリソースタイプに自身を登録しています。

前述の [プロキシコンポーネントパターン](#proxy-component-pattern) と組み合わせる場合、この形式の二重バインディングは、次のような優れた拡張ポイントを提供します。

1. サイトがSlingモデルの実装を再定義できるのは、HTLファイルについて考慮することなく、プロキシコンポーネントのリソースタイプに登録することで、そのインターフェイスをポイントできます。
1. サイトでは、参照する必要のある実装ロジックについて考慮する必要なく、コンポーネントのHTLマークアップを再定義できます。

## まとめると {#putting-it-all-together}

以下に、タイトルコアコンポーネントの例を説明するリソースタイプの連結構造全体の概要を示します。これは、サイト固有のプロキシコンポーネントがコンポーネントのバージョンを解決する方法を示し、コンテンツリソースにバージョン番号が含まれていることを回避します。次に、コンポーネントの `title.html`[HTL](https://helpx.adobe.com/experience-manager/htl/using/overview.html) ファイルがモデルインターフェイスにどのように使用されるかを示しますが、実装は [Slingモデル](https://sling.apache.org/documentation/bundles/models.html) 注釈を介してコンポーネントの特定のバージョンにバインドされます。

![リソースバインディングの概要](assets/chlimage_1-32.png)

以下に、実装POJOの詳細を示していない別の概要を示します。ただし、関連 [付けられたテンプレートとポリシー](https://helpx.adobe.com/experience-manager/6-5/sites/developing/using/page-templates-editable.html) の参照方法を示しています。

`cq:allowedTemplates` このプロパティは、サイトに使用できるテンプレートを示し、関連 `cq:template` するテンプレートが何であるかを各ページに示します。すべてのテンプレートは、次の3つの部分で構成されています。

* **structure**各ページで強制的に存在するリソース、およびページの作成者がページヘッダーやフッターコンポーネントなどの削除できないリソースを含みます。
* **initial**ページの作成時に複製される初期コンテンツを指定します。
* **policies**各コンポーネントについて、コンポーネントの事前設定である、ポリシーへのマッピングを含みます。このマッピングにより、ポリシーをテンプレート間で再利用し、一元管理することができます。

![テンプレートとポリシーの概要](assets/screen_shot_2018-12-07at093102.png)

**関連項目：**

* [コアコンポーネント](using.md) の使用-独自のプロジェクトのコアコンポーネントの使用を習得できます。
* [コアコンポーネントのカスタマイズ](customizing.md) -コアコンポーネントのスタイル設定とカスタマイズ方法について説明します。
